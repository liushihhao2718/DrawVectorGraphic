<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <base data-ice="baseUrl" href="../../">
  <title data-ice="title">src/Path.js | API Document</title>
  <link type="text/css" rel="stylesheet" href="css/style.css">
  <link type="text/css" rel="stylesheet" href="css/prettify-tomorrow.css">
  <script src="script/prettify/prettify.js"></script>
  
  
  <script src="script/manual.js"></script>
</head>
<body class="layout-container" data-ice="rootContainer">

<header>
  <a href="./">Home</a>
  
  <a href="identifiers.html">Reference</a>
  <a href="source.html">Source</a>
  
  
  <div class="search-box">
  <span>
    <img src="./image/search.png">
    <span class="search-input-edge"></span><input class="search-input"><span class="search-input-edge"></span>
  </span>
    <ul class="search-result"></ul>
  </div>
</header>

<nav class="navigation" data-ice="nav"><div>
  <ul>
    
  <li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/Node.js~Node.html">Node</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/NodeController.js~NodeController.html">NodeController</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/Path.js~Path.html">Path</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/Tool.js~DrawTool.html">DrawTool</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/Tool.js~SelectTool.html">SelectTool</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/Tool.js~Tool.html">Tool</a></span></span></li>
</ul>
</div>
</nav>

<div class="content" data-ice="content"><h1 data-ice="title">src/Path.js</h1>
<pre class="source-code line-number raw-source-code"><code class="prettyprint linenums" data-ice="content">export default class Path {
	constructor(key, target, nodes){
		this.target = target;//append to svg
		this.nodes = nodes||[];//optional
		this.key = key;
		this.closed = false;

		this.segmnetMap = new Map();
	}

	addNode(node){
		node.setParent(this);
		this.nodes.push(node);

		
		if (this.noSegment()) return;
		let lastOne = this.nodes.length - 1;
		this.drawLineSegment(this.nodes[lastOne-1],
			this.nodes[lastOne]);
	}

	noSegment(){
		return (this.nodes.length &lt;= 1);
	}
	makePathDescription(){
		let path_description = &apos;&apos;,
			flag;
		for (var i = 0; i &lt; this.nodes.length; i++) {
			if(i===0) flag = &apos;M&apos;;

			else if(this.nodes[i].type === &apos;line&apos;) flag = &apos; L&apos;;


			path_description +=`${flag}${this.nodes[i].center.x} ${this.nodes[i].center.y}`;
		}

		if (this.closed) path_description+=&apos;Z&apos;;

		return path_description;
	}

	drawPath(){
		this.view.attr(&apos;d&apos;, this.makePathDescription());
	}
	drawLineSegment(p1, p2){
		let d = this.makeLineDescript(p1, p2),
			segment = this.target.path(d),
			segmentKey = `${this.key}-${this.nodes.indexOf(p1)}`;
		segment.attr({
			id:segmentKey,
			class:&apos;segment&apos;
		});
		this.segmnetMap.set(segmentKey, segment);
	}
	makeLineDescript(p1, p2){
		//Mx1 y1 L x2 y2
		return `M ${p1.center.x} ${p1.center.y}`
			+` L ${p2.center.x} ${p2.center.y}`;
	}
	updateSegment(index){
		if(!this.closed){
			if(index === 0) this.updatePresentSegment(index);
			else if(index === this.nodes.length-1) this.updatePrevSegment(index);
		}
		else{
			this.updatePrevSegment(index);
			this.updatePresentSegment(index);
		}
	}

	updatePrevSegment(present){
		let	size = this.nodes.length,
			prev = (present - 1 + size)%size,
			prevSeg = this.segmnetMap.get(`${this.key}-${prev}`),
			prev_d = this.makeLineDescript(this.nodes[prev], this.nodes[present]);
		prevSeg.attr(&apos;d&apos;, prev_d);
	}

	updatePresentSegment(present){
		let size = this.nodes.length,
			next = (present + 1 + size)%size,
			presentSeg = this.segmnetMap.get(`${this.key}-${present}`),
			present_d = this.makeLineDescript(this.nodes[present], this.nodes[next]);
		presentSeg.attr(&apos;d&apos;, present_d);

	}
	firstNode(){
		return this.nodes[0];
	}

	lastNode(){
		return this.nodes[this.nodes.length-1];
	}
	clearSelected(){
		for(let node of this.nodes){
			node.setSelected(false);
		}
	}
	closePath(){
		this.closed = true;
		this.drawLineSegment(this.lastNode(), this.firstNode());
	}
}</code></pre>

</div>

<footer class="footer">
  Generated by <a href="https://esdoc.org">ESDoc<span data-ice="esdocVersion">(0.4.8)</span></a>
</footer>

<script src="script/search_index.js"></script>
<script src="script/search.js"></script>
<script src="script/pretty-print.js"></script>
<script src="script/inherited-summary.js"></script>
<script src="script/test-summary.js"></script>
<script src="script/inner-link.js"></script>
<script src="script/patch-for-local.js"></script>
</body>
</html>
